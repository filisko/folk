/*! Delegato - v1.0.0 - 2015-09-24
* https://github.com/MiniPlugins/delegato
* Copyright (c) 2015 Berto Yáñez, Óscar Otero; Licensed MIT */

!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(b,c){this.element=b,this.settings=a.extend({},d,c),this.pattern=/(?:\(([^\)]+)\))?([^:|]+):?([^|]+)?/,this.actions={},this.init()}var c="delegato",d={includeJquery:!1};b.prototype={init:function(){var b=this.actions,c=this.pattern,d=this.settings.includeJquery,e=function(b){var c;try{c=a(b)}catch(d){return!1}return c},f=function(a,b){var c=b.match(/^([^@]+)(?:@(.*))?$/),d=c[1],f=c[2];if(!d)throw new Error("Invalid selector");var g;switch(d){case"this":g=a;break;case"parent":g=a.parent();break;case"next":g=a.next();break;case"prev":g=a.prev();break;case"parent-next":g=a.parent().next();break;case"parent-prev":g=a.parent().prev();break;default:g=e(d)}if(!g)throw new Error("Invalid selector");return f?g.find(f):g};a(this.element).on("click","[data-action]",function(e){var g=a(this),h=g.data("action"),i=g.data("target")||g.attr("href");h.split("|").forEach(function(h){var j=h.match(c);if(j){var k=j[1]?j[1]:i,l=j[2],m=j[3]?j[3].split(","):[],n=f(g,k);if(a.isFunction(b[l]))m.unshift(e),b[l].apply(n,m);else{if(!d||!a.isFunction(n[l]))throw new Error("Malformed action");n[l].apply(n,m)}}}),e.stopPropagation(),e.preventDefault()})},register:function(a,b){this.actions[a]=b},unregister:function(a){this.actions[a]&&delete this.actions[a]}},a.fn[c]=function(d){if(void 0===d||"object"==typeof d)return this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(this,d))});if("string"==typeof d&&"_"!==d[0]&&"init"!==d){var e,f=arguments;return this.each(function(){var g=a.data(this,"plugin_"+c);g instanceof b&&"function"==typeof g[d]&&(e=g[d].apply(g,Array.prototype.slice.call(f,1))),"destroy"===d&&a.data(this,"plugin_"+c,null)}),void 0!==e?e:this}}});