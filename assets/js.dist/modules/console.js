define(["jquery"],function(e){return{init:function(t){var n=t.find(".console-input"),r=t.find(".console-output"),i=[],s=0;t.on("submit",function(o){o.preventDefault(),r.append('<div class="command-request">'+n.val()+"</div>");var u=!1;e.ajax({method:t.attr("method"),data:t.serialize(),url:t.attr("action"),xhrFields:{onprogress:function(e){var t=e.currentTarget.response,n=u===!1?t:t.substring(u);u=t.length,r.append('<div class="command-response">'+n+"</div>").scrollTop(r[0].scrollHeight)}}}).done(function(){i.push(n.val()),s=i.length,n.val("")}).fail(function(e){r.append('<div class="command-response"><span class="error">Http error: '+e+"</span></div>")})}),n.on("keypress",function(e){switch(e.keyCode){case 38:i[s-1]!==undefined&&n.val(i[--s]);break;case 40:i[s+1]!==undefined?n.val(i[++s]):(i[s]!==undefined&&++s,n.val(""));break;default:return}e.preventDefault()})}}});